<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auto Save Text</title>

<style type="text/css">
 
 .navbar {
  background-color: #333;
  overflow: hidden;
}

.navbar a {
  float: left;
  display: block;
  color: white;
  text-align: center;
  padding: 14px 20px;
  text-decoration: none;
}

.navbar a:hover {
  background-color: #ddd;
  color: black;
}

textarea {
 background: url(https://i.stack.imgur.com/ynxjD.png) repeat-y;
 width: 900px;
 height: 700px;
 font: normal 14px verdana;
 line-height: 20px;
 padding: 2px 10px;
 border: solid 1px #ddd;
}
 
</style>
</head>
<body>

<div class="navbar">
  <a href="https://hstech.cl/text/index.html">Text 1</a>
  <a href="https://hstech.cl/text/text2/index.html">Text 2</a>
  <a href="https://hstech.cl/text/text3/index.html">Text 3</a>
  <a href="https://hstech.cl/text/text4/index.html">Text 4</a>
  <a href="https://hstech.cl/text/text5/index.html">Text 5</a>
    <a href="https://hstech.cl/text/text6/index.html">Text 6</a>
</div>

<textarea id="textArea"></textarea>

<script>

    document.addEventListener('DOMContentLoaded', function() {
        // Function to fetch data from the database via AJAX
        function fetchData() {
            var xmlhttp = new XMLHttpRequest();

            // Define a callback function to handle the response
            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == XMLHttpRequest.DONE && xmlhttp.status == 200) {
                    // Request successful, update textarea with received data
                    document.getElementById('textArea').value = xmlhttp.responseText;
                } else {
                    // Request failed
                    console.error('Error: ' + xmlhttp.status);
                }
            };
            var url = "getText.php"; // URL to your PHP script

            // Configure the request
            xmlhttp.open("GET", url, true);

            // Send the request
            xmlhttp.send();
        }

        // Call fetchData function when the page loads
        fetchData();
    });

    // Load saved text if available
    //textArea.value = localStorage.getItem('textArea') || '';
    // Save text whenever there is a change

    textArea.addEventListener('input', function() {
	
	//setTimeout(function(){
		localStorage.setItem('savedText', textArea.value);
        saveTextToDatabase(textArea.value); // Call function to save text to database
//}, 200);       
    });

    // Function to save text to database via AJAX
    function saveTextToDatabase(text) {
 
        const textArea = document.getElementById('textArea');

        var xmlhttp = new XMLHttpRequest();

    // Define a callback function to handle the response
        xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == XMLHttpRequest.DONE && xmlhttp.status == 200) {
                // Request successful, handle response
                console.log(xmlhttp.responseText);
            } else {
                // Request failed
                console.error('Error: ' + xmlhttp.status);
                    }
    };

     var url = "saveText.php";

    // Define the data to be sent
    var data = "text="+text; // Replace with your actual data

    // Configure the request
    // Continue with the request
    xmlhttp.open("POST", url, true);
    xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

   // Send the request with the data
   xmlhttp.send(data);
 
  }
		
</script>

</body>
</html>
